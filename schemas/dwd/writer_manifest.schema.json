{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "schemas/dwd/writer_manifest.schema.json",
    "title": "Writer Manifest (ClimaStation)",
    "description": "Deterministic summary for each written Parquet file; used by golden tests.",
    "type": "object",
    "additionalProperties": false,
    "required": [
        "dataset_key",
        "station_id",
        "year",
        "row_count",
        "min_ts",
        "max_ts",
        "schema_fingerprint",
        "first_100_rows_csv_sha256"
    ],
    "properties": {
        "dataset_key": {
            "type": "string",
            "description": "Dataset key (e.g., '10_minutes_air_temperature')."
        },
        "station_id": {
            "type": "string",
            "description": "Zero-padded 5-digit station id.",
            "pattern": "^\\d{5}$",
            "examples": [
                "00003",
                "12345"
            ]
        },
        "year": {
            "type": "integer",
            "description": "Calendar year covered by this Parquet file.",
            "minimum": 1800,
            "maximum": 2100
        },
        "row_count": {
            "type": "integer",
            "description": "Number of rows written to the Parquet file.",
            "minimum": 0
        },
        "min_ts": {
            "type": "string",
            "description": "Earliest UTC timestamp present (ISO 8601, 'Z' suffix).",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
            "examples": [
                "1993-04-28T00:00:00Z"
            ]
        },
        "max_ts": {
            "type": "string",
            "description": "Latest UTC timestamp present (ISO 8601, 'Z' suffix).",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
            "examples": [
                "1993-12-31T23:50:00Z"
            ]
        },
        "schema_fingerprint": {
            "type": "string",
            "description": "SHA-256 over the Arrow schema JSON.",
            "pattern": "^sha256:[0-9a-f]{64}$",
            "examples": [
                "sha256:0123abcde0123abcde0123abcde0123abcde0123abcde0123abcde0123abcde0"
            ]
        },
        "first_100_rows_csv_sha256": {
            "type": "string",
            "description": "SHA-256 of CSV encoding of the first 100 rows (deterministic debug sample).",
            "pattern": "^[0-9a-f]{64}$",
            "examples": [
                "abcdefabcdefabcdefabcdefabcdefabcdefabcdefabcdefabcdefabcdefabcd"
            ]
        }
    },
    "examples": [
        {
            "dataset_key": "10_minutes_air_temperature",
            "station_id": "00003",
            "year": 1993,
            "row_count": 123456,
            "min_ts": "1993-04-28T00:00:00Z",
            "max_ts": "1993-12-31T23:50:00Z",
            "schema_fingerprint": "sha256:8b3a0d9b7c3b16a0c8d8c2ef6f0a2d2c6bd1a9e5b6cbf3e4a7f1d2c3b4a5e6f7",
            "first_100_rows_csv_sha256": "3c9e2b8d0f7a1c2e4b6d8f0a1b2c3d4e5f60718293a4b5c6d7e8f90123456789"
        }
    ]
}